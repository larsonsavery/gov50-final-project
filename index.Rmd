---
title: "Gov 50 Final Project"
author: "Larson Avery"
description: "Identifying demographic trends and variables that lead polls astray"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

Milestone 1:
I want to dive into data from a recent federal election, probably related to  House of Representatives races and compare polls leading up to the election with the actual results. I want to combine US Census data with polling to create a large dataset of demographic, economic, or geographic variables. Then I want to investigate if trends in these variables make polls accurate or inaccurate at predicting election outcomes.

Milestone 2:
Research Question: How did percentage of workers in the manufacturing sector, unemployment, and percent of households making under $15,000 a year affect the accuracy of polls in the 2016 Presidential election? Polls put Hillary Clinton ahead of Donald Trump and while he did not win the popular vote, he did win far more votes than expected due to the undercounting of voters. I want to explore how variables such as rural poverty, loss of manufacturing jobs, and unemployment—issues Trump emphasized—affected how accurate polls were for the 2016 Presidential Election. I hypothesize states with a higher manufacturing share, higher unemployment, and high proportions of poor households increases discrepancies between predicted and actual vote shares in FiveThirtyEight’s model. The explanatory variables are from a table on the US Census website that measure a variety of different economic variables. These are extremely recent and accurate as the Census reaches the vast majority of the US population. The outcome variable is the predicted popular vote for Trump by FiveThirtyEight (measured by aggregating many polls together) minus the final results of the popular vote by state. Each variable will be measured separately. A positive relationship between the variables and poll error with low standard deviation will support my hypothesis whereas a weak relationship or opposite relationship will disprove my hypothesis. 

Unfortunately at this time I have been unable to find FiveThirtyEight’s predicted popular vote share for 2016. I have found this dataset for 2020 on GitHub but a study of those results would be far less interesting as pollsters probably adjusted to polling for Trump between 2016 and 2020.



Demographic data: https://data.census.gov/cedsci/table?q=employment%20statistics&g=0100000US,%240400000&tid=ACSDP1Y2021.DP03&moe=false&tp=true

Election Polls: *need to find 2016 version
https://github.com/fivethirtyeight/data/tree/master/election-forecasts-2020 ->
https://projects.fivethirtyeight.com/2020-general-data/presidential_poll_averages_2020.csv

Election Results:
https://www.fec.gov/resources/cms-content/documents/federalelections2016.pdf

Milestone 3: 
I have completely pivoted to a new topic. Now I am investigating constitutional emergency powers enumeration and how it affects government liberality in the Post-Cold War world. So far I have created two graphs. See below.
---
title: "Constitutions"
output:
  pdf_document: default
  html_document: default
date: "2022-10-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(dplyr)
library(infer)

```

```{r}
constitution <- read_csv("ccpcnc_v4_small.csv")
```


```{r}
constitution <- constitution |>
  drop_na(em) |>
  select(country:evnttype, em:emother_98) |>
  filter(year > "1988")
```

```{r}
liberal <- read_csv("V-Dem.csv")
```

```{r}
liberal <- liberal |>
  select(country_name, year, v2x_libdem, v2mecenefm, 
         v2mecenefi, v2mecrit, v2mebias) |>
  filter(year > "1988")
```

Finding differences in country names to prevent errors in `inner_join`
```{r}
#unique(liberal$country_name)
#unique(constitution$country)
```

```{r}
liberal <- liberal |>
  rename(country = country_name)
```

##Filtering out duplicate data in constitution
```{r}
##This filters out all Serbia data, why isn't the "and" function (&) not working
constitution <- constitution |>
  filter(country != "Serbia" & year != "2006")  

```

##Left Join
```{r}
joined <- constitution |>
  left_join(liberal) |>
  select(country, year, v2x_libdem, em, emdecl, emappr_1, emappr_2) 
```

##Summarizing variables

```{r}
joined <- joined |>
  mutate(emdecl = case_when(
    emdecl == 1 ~ "Head of State",
    emdecl == 2 ~ "Head of Government",
    emdecl == 3 ~ "Head of State or Head of Gov",
    emdecl == 4 ~ "Gov/Cabinet",
    emdecl == 5 ~ "1st Legislative Chamber",
    emdecl == 6 ~ "2nd Legislative Chamber",
    emdecl == 7 ~ "Both Chambers",
    emdecl == 90 ~ "Left to law",
    emdecl == 96 ~ "Other",
    emdecl == 97 ~ "Unknown",
    emdecl == 98 ~ "Not Specified",
    emdecl == 99 ~ "Not Applicable"
  ))

```
```{r}
target_data <- joined |>
  group_by(emdecl) |>
  summarize(mean_liberal = mean(v2x_libdem, na.rm = TRUE)) #|>
  #pivot_wider(names_from = emdecl, values_from = mean_liberal)  
target_data
```


Bar Plot
```{r}
target_data |>
  ggplot(aes(x = emdecl,  y = mean_liberal)) +
  geom_bar(stat = "identity") +
  scale_x_discrete(guide = guide_axis(n.dodge=2)) +
  labs(x = "Who Declares State of Emergencies",
       y = "V-Dem Liberal Democracy Index")
  

  
```
```{r}
joined <- joined |>
  mutate(em = case_when(
    em == 1 ~ "Provision",
    em == 2 ~ "No Provision",
    em == 96 ~ "Other",
    em == 97 ~ "unknown")
      )
target_data2 <- joined |>
  group_by(em) |>
  summarize(mean_liberal = mean(v2x_libdem, na.rm = TRUE)) |>
  filter(!row_number() %in% (2))
target_data2
```

```{r}
target_data2 |>
  ggplot(aes(x = em, y = mean_liberal)) +
  geom_bar(stat = "identity") +
  labs(x = "Provision on Calling a State of Emergency in the Constitution", 
       y = "V-Dem Liberal Democracy Index",
       title = "Effect of Having a Provision About State of Emergencies on Liberal Democracy")
```


  


